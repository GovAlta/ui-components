import { Meta, Story } from "@storybook/addon-docs";
import {
  Tabs,
  Tab,
  CodeSnippet,
  SupportInfo,
  Props,
  Prop,
} from "@abgov/shared/storybook-common";
import {
  GoADropdown,
  GoADropdownItem,
  GoACallout,
} from "@abgov/react-components";
import { useState } from "react";

<Meta title="Components/Dropdown" />

# Dropdown

### Dropdowns hide a long list of options, arranged vertically. A single select menu list is revealed upon interaction with this component.

[Figma design component](https://www.figma.com/file/3pb2IK8s2QUqWieH79KdN7/%E2%9D%96-Components-%7C-DIO-DS?node-id=700%3A7316)

---

#### Dropdown properties

<Props showTabs={true}>
  <Prop
    name="name"
    type="string"
    description="Must be unique in the rendered view and must match the children's name"
  />
  <Prop
    name="value"
    type="string"
    description="Stores the value of the item selected from the dropdown"
  />
  <Prop
    name="leadingIcon"
    type="GoAIconType"
    description="Show an icon to the left of the dropdown option. **Non-native only**"
  />
  <Prop
    name="maxHeight"
    type="string"
    defaultValue="276px"
    description="Maximum height of the dropdown menu items popover. **Non-native only**"
  />
  <Prop
    name="placeholder"
    type="string"
    description="The text displayed for the dropdown before a selection is made. **Non-native only**"
  />
  <Prop
    name="width"
    type="string"
    description="Override the autosized menu width"
  />
  <Prop
    name="disabled"
    lang="angular"
    type="boolean"
    defaultValue="false"
    description="Disable this control. **Use [attr.disabled] with [formControl]**"
  />
  <Prop
    name="disabled"
    lang="react"
    type="boolean"
    defaultValue="false"
    description="Disable this control"
  />
  <Prop
    name="relative"
    type="boolean"
    defaultValue="false"
    description="Set to true if a parent element has a css position of `relative`"
  />
  <Prop
    name="error"
    type="boolean"
    defaultValue="false"
    description="Show an error state"
  />
  <Prop
    name="ariaLabel"
    type="string"
    description="Defines how the selected value will be translated for the screen reader. If not specified it will fall back to the name"
  />
  <Prop
    name="native"
    type="boolean"
    defaultValue="false"
    description="When true will render the native <select> html element"
  />
  <Prop
    name="onChange"
    lang="react"
    type="(name: string, values: string[] | string) => void"
    description="Callback function when dropdown value is changed"
  />
</Props>
<GoACallout>
  When using a dropdown inside a modal where there is limited space for the menu
  items to display, ensure the "native" property is set to "true" for the
  dropdown to function properly.
</GoACallout>
<details>
  <summary>Additional Properties</summary>
  <Props showTabs={true}>
    <Prop
      name="mt"
      type="none | 3xs | 2xs | xs | s | m | l | xl | 2xl | 3xl | 4xl"
      defaultValue="none"
      description="Top margin"
    />
    <Prop
      name="mr"
      type="none | 3xs | 2xs | xs | s | m | l | xl | 2xl | 3xl | 4xl"
      defaultValue="none"
      description="Right margin"
    />
    <Prop
      name="mb"
      type="none | 3xs | 2xs | xs | s | m | l | xl | 2xl | 3xl | 4xl"
      defaultValue="none"
      description="Bottom margin"
    />
    <Prop
      name="ml"
      type="none | 3xs | 2xs | xs | s | m | l | xl | 2xl | 3xl | 4xl"
      defaultValue="none"
      description="Left margin"
    />
  </Props>
</details>

#### Dropdown item properties

<Props>
  <Prop
    name="value"
    type="string"
    description="The value of the item. This value will be contained within the onChange event"
  />
  <Prop
    name="label"
    type="string"
    description="The displayed value within the selection box. The `value` property is the fallback value."
  />
</Props>

export const Template = (args) => {
  const [value, setValue] = useState("");
  function onChange(name, value) {
    console.log(name, value);
    setValue(value);
  }
  return (
    <GoADropdown {...args} value={value} onChange={onChange}>
      <GoADropdownItem value="red" label="Red" />
      <GoADropdownItem value="green" label="Green" />
      <GoADropdownItem value="blue" label="Blue" />
    </GoADropdown>
  );
};

#### Basic

<Story name="Basic">{Template.bind()}</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" value={value} onChange={onChange}>
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>

#### Error

<Story name="Error" args={{ name: "error", error: true }}>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" error="true">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown name="colors" error="true">
          <goa-dropdown-item value="red" label="Red"></goa-dropdown-item>
          <goa-dropdown-item value="green" label="Green"></goa-dropdown-item>
          <goa-dropdown-item value="blue" label="Blue"></goa-dropdown-item>
        </goa-dropdown>
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        <GoADropdown name="colors" error={true} value={value} onChange={() => {}}>
          <GoADropdownItem value="red" label="Red" />
          <GoADropdownItem value="green" label="Green" />
          <GoADropdownItem value="blue" label="Blue" />
        </GoADropdown>
      `}
    />
  </Tab>
</Tabs>

#### Native

<Story name="Native">
  <GoADropdown
    name="native"
    onChange={(name, value) => console.log(name, value)}
    native={true}
  >
    <GoADropdownItem name="native" value="red" label="Red" />
    <GoADropdownItem name="native" value="green" label="Green" />
    <GoADropdownItem name="native" value="blue" label="Blue" />
  </GoADropdown>
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" native>
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          native="true"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" value={value} onChange={onChange} native={true}>
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>

#### Disabled

<Story name="Disabled" args={{ name: "disabled", disabled: true }}>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" disabled="true">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown name="colors" disabled="true">
          <goa-dropdown-item value="red" label="Red"></goa-dropdown-item>
          <goa-dropdown-item value="green" label="Green"></goa-dropdown-item>
          <goa-dropdown-item value="blue" label="Blue"></goa-dropdown-item>
        </goa-dropdown>
        <!-- Use [attr.disabled] with [formControl] -->
        <goa-dropdown name="colors" goaValue [formControl]="reactiveFormCtrl" [attr.disabled]="true">
          <goa-dropdown-item value="red" label="Red"></goa-dropdown-item>
          <goa-dropdown-item value="green" label="Green"></goa-dropdown-item>
          <goa-dropdown-item value="blue" label="Blue"></goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        <GoADropdown name="colors" disabled={true} value={value} onChange={() => {}}>
          <GoADropdownItem value="red" label="Red" />
          <GoADropdownItem value="green" label="Green" />
          <GoADropdownItem value="blue" label="Blue" />
        </GoADropdown>
      `}
    />
  </Tab>
</Tabs>

#### Leading icon

<Story name="Leading icon" args={{ name: "colors", leadingIcon: "airplane" }}>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" leadingicon="airplane">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value"
          leadingicon="airplane">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" value={value} onChange={onChange} leadingIcon="airplane">
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>

#### Max height

<Story name="Max height" args={{ name: "colors", maxHeight: "80px" }}>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" maxheight="80px">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value"
          maxheight="80px">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" value={value} onChange={onChange} maxHeight="80px">
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>

#### Placeholder

<Story
  name="Placeholder"
  args={{ name: "colors", placeholder: "Select a color" }}
>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" placeholder="Select a color">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value"
          placeholder="Select a color">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl();
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" onChange={onChange} placeholder="Select a color">
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>

#### Width

<Story name="Width" args={{ name: "colors", width: "350px" }}>
  {Template.bind()}
</Story>

<Tabs>
  <Tab label="Web Component" hidden={true}>
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown id="dropdown" name="colors" width="350px">
          <goa-dropdown-item value="red" label="Red" />
          <goa-dropdown-item value="green" label="Green" />
          <goa-dropdown-item value="blue" label="Blue" />
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        var dropdown = document.getElementById("dropdown");
        dropdown.addEventListener("_change", e => {
          console.log("_change", e.detail);
          dropdown.setAttribute("value", e.detail.value);
        });
      `}
    />
  </Tab>
  <Tab label="Angular">
    <CodeSnippet
      lang="html"
      code={`
        <goa-dropdown
          goaValue
          name="colors"
          [formControl]="reactiveFormCtrl"
          [value]="reactiveFormCtrl.value"
          width="350px">
          <goa-dropdown-item
            *ngFor="let color of colors"
            [value]="color"
            [label]="color"
          >
          </goa-dropdown-item>
        </goa-dropdown>
      `}
    />
    <CodeSnippet
      lang="js"
      code={`
        import { FormControl } from "@angular/forms";
        export class MyComponent {
          colors: string[] = ['red', 'green', 'blue'];
          reactiveFormCtrl = new FormControl("red");
        }
      `}
    />
  </Tab>
  <Tab label="React">
    <CodeSnippet
      lang="tsx"
      code={`
        const [value, setValue] = useState('green');
        function onChange(name: string, value: string | string[]) {
          setValue(value);
        }
        return (
          <GoADropdown name="colors" value={value} onChange={onChange} width="350px">
            <GoADropdownItem value="red" label="Red" />
            <GoADropdownItem value="green" label="Green" />
            <GoADropdownItem value="blue" label="Blue" />
          </GoADropdown>
        )
      `}
    />
  </Tab>
</Tabs>
---

<SupportInfo />
