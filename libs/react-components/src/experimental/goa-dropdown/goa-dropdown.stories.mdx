import {
  Meta,
  Canvas,
  Story,
  Description,
  ArgsTable,
} from '@storybook/addon-docs/blocks';
import { WCDropdown } from './goa-dropdown';
import { WCDropdownOption } from './goa-dropdown-option';
import { useState } from 'react';
import { action } from '@storybook/addon-actions';
import {
  BestPractices,
  BestPracticeItem,
  StateDisplay,
} from '@abgov/shared/storybook-common';

<Meta title="React/Web Components/Dropdown" component={WCDropdown} />

export const Template = (args) => {
  const [selectedValues, setValues] = useState(args.selectedValues);
  function onChange(name, values) {
    setValues(values);
  }
  return (
    <StateDisplay
      title="Dropdown Example"
      description="A dropdown component that allows for selection of one or more items."
      state={selectedValues}
    >
      <WCDropdown
        {...args}
        name="basic"
        onChange={onChange}
        selectedValues={selectedValues}
      >
        <WCDropdownOption name="basic" label="Option 1" value="option1" />
        <WCDropdownOption
          name="basic"
          label="Nicholas Cage"
          value="Nicholas cage"
        >
          {/* <!-- Custom content can be added --> */}
          <div slot="foo" style={{ display: 'flex', alignItems: 'center' }}>
            <img
              height="40"
              width="40"
              style={{ borderRadius: '50%' }}
              src="https://www.placecage.com/40/40"
            />
            <span style={{ paddingLeft: '8px' }}>Nicholas Cage</span>
          </div>
        </WCDropdownOption>
        <WCDropdownOption name="basic" label="Option 3" value="option3" />
        <hr />
        <WCDropdownOption name="basic" label="Option 4" value="option4" />
        <WCDropdownOption name="basic" label="Option 5" value="option5" />
        <WCDropdownOption name="basic" label="Option 6" value="option6" />
      </WCDropdown>
    </StateDisplay>
  );
};

<Canvas>
  <Story
    name="Dropdown"
    height="500px"
    args={{
      selectedValues: ['option1'],
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

<Canvas>
  <Story
    name="Autocomplete"
    height="500px"
    args={{
      autoComplete: true,
      selectedValues: ['option1'],
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

```tsx
export const Template = (args) => {
  const [selectedValues, setValues] = useState(args.selectedValues);
  function onChange(name, values) {
    setValues(values);
  }
  return (
    <>
      <WCDropdown
        {...args}
        name="basic"
        onChange={onChange}
        selectedValues={selectedValues}
      >
        <label>Some Label</label>
        <WCDropdownOption label="Option 1" value="option1" />
        <WCDropdownOption label="Option 2" value="option2" />
        <WCDropdownOption label="Option 3" value="option3" />
        <hr />
        <WCDropdownOption label="Option 4" value="option4" />
        <WCDropdownOption label="Option 5" value="option5" />
        <WCDropdownOption label="Option 6" value="option6" />
      </WCDropdown>
    </>
  );
};
```

## Properties

<Description of={WCDropdown} />
<ArgsTable of={WCDropdown} />

<Description of={WCDropdownOption} />
<ArgsTable of={WCDropdownOption} />

## Testing

To perform frontend tests you can use the self-defined `data-testid` attributes to obtain DOM references to attach events onto.
The `data-testid` attributes of the parent and children are based of the name attribute defined in the `<WCDropdown>` parent component.
The `data-testid` values are shown below:

**Dropdown (root)**:
`[name]-dropdown`

**Background**:
`[name]-dropdown-background`

**DropdownOption**:
`[name]-dropdown-option--[value]`

### Example:

```tsx
<WCDropdown name="favColor">
  <WCDropdownOption label="Red" value="red" />
  <WCDropdownOption label="Green" value="green" />
  <WCDropdownOption label="Blue" value="blue" />
</WCDropdown>
```

```html
<div class="goa-dropdown-box">
  <div
    data-testid="favColor-dropdown-background"
    class="goa-dropdown-background"
  ></div>
  <div data-testid="favColor-dropdown" class="goa-dropdown-input " tabindex="0">
    <input readonly="" placeholder="Select..." />
    <div class="goa-icon" data-testid="icon-chevronDown" style="width: 20px;">
      <!-- chevron svg...-->
    </div>
  </div>
  <ul class="goa-dropdown-list">
    <div class="goa-scrollable">
      <div>
        <li
          data-testid="favColor-dropdown-option--red"
          class="goa-dropdown-option goa-dropdown-option--selected"
        >
          Red
        </li>
        <li
          data-testid="favColor-dropdown-option--green"
          class="goa-dropdown-option"
        >
          Green
        </li>
        <li
          data-testid="favColor-dropdown-option--blue"
          class="goa-dropdown-option"
        >
          Blue
        </li>
      </div>
    </div>
  </ul>
</div>
```

<BestPractices>
  <BestPracticeItem description="When dealing with 5 or less options, consider using radio buttons instead of a dropdown list" />
</BestPractices>
